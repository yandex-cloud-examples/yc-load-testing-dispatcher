# Диспетчер
Сервис сбора пользовательских запросов и записи их в файлы данных для нагрузочного теста.\
Сервис проксирует http запросы через себя на отслеживаемый сервер и ответы сервера обратно клиенту. В случае если проксированный запрос вернулся с кодом ответа 2хх, запрос сохраняется в структуры данных в отдельные файлы для использования их для нагрузочного теста. С помощью флагов можно переопределить правила и полноту сохраняемых данных. Запросы сохраняются в отдельные файлы локальной директории диспетчера:
- Файл **uri.payload** содержит только GET запросы;
- Файл **uripost.payload** содержит только POST запросы;
- Файлы **raw.payload** и **httpjson.payload** содержат запросы всех методов;

Для использования утилиты нужно запустить её с желаемыми флагами. Например\
```dispatcher_nix -target 'yandex.ru' -port 8080 -nostatic```\
или при использовании файла с кодом\
```go run dispatcher.go -target 'yandex.ru' -port 8080 -nostatic```\
После чего, все запросы, которые планируется использовать в нагрузочном тесте можно делать по адресу **localhost:8080**. Также можно в браузере открыть страницу **localhost:8080** и должен будет загрузиться сайт, указанный во флаге **target**.\
Можно запускать и без флага **target**. Тогда в качестве целевого сервера будет использован адрес, указанный в заголоввке **Host** запроса. 

### Флаги запуска 
- **port**     - Порт, на котором будет запущен сервер. По умоллчанию 8888;
- **target**   - Адрес сервиса, для которого выполняется проксиррование и сохранние запросов;
- **ssl**      - Проксировать запросы через https подключение;
- **noproxy**  - Сохранять запросы без проксирования;
- **saveall**  - Сохранять запросы вне зависимости от кода ответа по проксированному запросу;
- **nostatic** - Не сохрянять запросы статического контента, такого как css, js, jpeg, jpg, png, gif, ico, svg, woff, woff2.

